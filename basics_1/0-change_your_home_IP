#!/usr/bin/env bash
# This script replaces localhost with 127.0.0.2 and facebook.com with 8.8.8.8 in /etc/hosts

set -euo pipefail

HOSTS_FILE="/etc/hosts"

if [ "$EUID" -ne 0 ]; then
  echo "Please run as root." >&2
  exit 1
fi

cp "$HOSTS_FILE" "${HOSTS_FILE}.bak"

# Remove existing entries
grep -vE '\slocalhost\b|\sfacebook\.com\b' "$HOSTS_FILE" > /tmp/hosts.tmp

# Add mappings
{
  echo "127.0.0.2 localhost"
  echo "8.8.8.8 facebook.com"
} >> /tmp/hosts.tmp

mv /tmp/hosts.tmp "$HOSTS_FILE"
chmod 644 "$HOSTS_FILE"
